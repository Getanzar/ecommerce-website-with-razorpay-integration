{% extends 'base.html' %}
{% block title %}{{ product.name }} | Shop Minimal{% endblock %}

{% block content %}
<div class="row g-4">
    <!-- Product Image -->
    <div class="col-md-5">
        {% if product.image %}
            <img src="{{ product.image.url }}" class="img-fluid border" alt="{{ product.name }}">
        {% else %}
            <img src="/static/img/default.jpg" class="img-fluid border" alt="{{ product.name }}">
        {% endif %}
    </div>

    <!-- Product Details -->
    <div class="col-md-7">
        <h2>{{ product.name }}</h2>
        <p class="text-muted mb-1">Category: {{ product.category.name }}</p>
        <h4 class="text-success">₹{{ product.price }}</h4>
        
        <p class="mt-3">{{ product.description|linebreaks }}</p>

        <!-- ✅ Correct Add to Cart form -->
        <div class="mt-4">
            <form action="{% url 'add_to_cart' product.id %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-lg btn-warning">
                    Add to Cart
                </button>
            </form>
        </div>
    </div>
</div>

<hr>

<!-- Related Products -->
<h4 class="mt-5">Related Products</h4>
<div class="row g-4">
   {% for related in related_products %}
    <div class="col-6 col-md-3">
        <div class="card h-100 shadow-sm">
            <a href="{% url 'product_detail_page' slug=related.slug %}">
                {% if related.image %}
                    <img src="{{ related.image.url }}" class="card-img-top" alt="{{ related.name }}">
                {% else %}
                    <img src="/static/img/default.jpg" class="card-img-top" alt="{{ related.name }}">
                {% endif %}
            </a>
            <div class="card-body text-center">
                <h6 class="mb-1">{{ related.name }}</h6>
                <div class="text-muted">₹{{ related.price }}</div>

                <!-- ✅ Add to Cart button for related products -->
                <form action="{% url 'add_to_cart' related.id %}" method="post" class="mt-2">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-success">
                        Add to Cart
                    </button>
                </form>
            </div>
        </div>
    </div>
    {% empty %}
    <p class="text-muted">No related products found.</p>
    {% endfor %}
</div>
{% endblock %}
